---
title: "[TIL] 2025-08-21 | 교착 상태 해결하기"
summary: ""
date: "August 21 2025"
draft: false
tags:
  - "202508"
  - TIL
  - Project
---

# 1. 오늘 학습한 내용

좋아요 기능 구현 후 동시성 테스트

낙관적 락 적용: @Version을 추가하여 막으려 했으나, 교착 상태라는 다른 문제 발견

Deadlock 원인 분석: likes 테이블 INSERT와 post 테이블 UPDATE의 락 획득 순서가 꼬이는 문제라고 판단

최종 해결: JPA의 더티 체킹에 의존하지 않고, @Query를 이용한 UPDATE를 먼저 명시적으로 실행하여 락 획득 순서를 강제함으로써 Deadlock을 해결

비관적 락과 유사한 느낌

버전을 제어하는 방식으로 개선 필요